(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{40:function(e,t,a){e.exports=a(99)},46:function(e,t,a){},98:function(e,t,a){},99:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(23),r=a.n(s),l=a(14),c=(a(46),a(15)),o=a(39),p=a(3),u=a(2),m=a.n(u),h=a(9),d=a(10),g=a(12),f=a(11),b=a(13),v=a(1),E=a(18),S=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(f.a)(t).call(this,e))).state={games:[]},a.getGames=a.getGames.bind(Object(v.a)(Object(v.a)(a))),a.playGame=a.playGame.bind(Object(v.a)(Object(v.a)(a))),a}return Object(b.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getGames()}},{key:"getGames",value:function(){var e=this;m.a.get("/api/games").then(function(t){t.data&&e.setState({games:t.data})}).catch(function(e){return console.log(e)})}},{key:"playGame",value:function(e){this.setState({redirect:"/play/".concat(e,"/")})}},{key:"render",value:function(){var e=this;if(this.state.redirect)return i.a.createElement(p.a,{to:this.state.redirect});var t=this.state.games.map(function(t){return i.a.createElement("div",{className:"item centered",key:E()},i.a.createElement("h2",null,t.name),i.a.createElement("p",null,t.snippets.length," Snippets"),i.a.createElement("button",{onClick:function(){e.setState({redirect:"/game-results/".concat(t.id)})}},"View Results"),i.a.createElement("button",{onClick:function(){return e.playGame(t.id)}},"Contribute \u2192"))});return i.a.createElement("div",{className:"wrapper"},i.a.createElement("div",{className:"wrapperFlex"},t))}}]),t}(i.a.Component),y=a(20),O=a.n(y),j=a(37),C=a.n(j),N=a(18),k=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(f.a)(t).call(this,e))).state={snippet:{}},a}return Object(b.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.snippetData&&this.props.interpsData)this.setState({snippet:this.props.snippetData,interps:this.props.interpsData,snippetChars:this.props.snippetData.text.split("")});else{var t=this.props.snippetId;this.props.match&&void 0===(t=this.props.match.params.id)&&(t=this.props.snippetId),m.a.get("/api/snippets/".concat(t)).then(function(t){t.data&&e.setState({snippet:t.data[0],interps:t.data[0].interps,snippetChars:t.data[0].text.split("")})}).catch(function(e){return console.log(e)})}}},{key:"render",value:function(){var e=this,t=i.a.createElement("div",null);return this.state.interps&&(t=this.state.snippetChars.map(function(t,a){var n=e.state.interps.map(function(e,t){return e.selection[a]}).reduce(function(e,t){return t?e+1:e})/e.state.interps.length,s="rgba(249, 140, 94, ".concat(n.toString(),")"),r="rgba(0, 0, 0, ".concat(n.toString(),")"),l={backgroundColor:"highlight"===e.props.method?s:"",color:"opacity"===e.props.method?r:""};return i.a.createElement("span",{style:l,key:N()},t)})),i.a.createElement("div",null,t)}}]),t}(i.a.Component),x=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(f.a)(t).call(this,e))).state={pageNum:1,highlightedRange:[],gameSnippets:[],fullSnippets:[],selections:[],loadingNew:!0,submittedCurrent:!1,mobileInput:""},a.getGame=a.getGame.bind(Object(v.a)(Object(v.a)(a))),a.getSnippet=a.getSnippet.bind(Object(v.a)(Object(v.a)(a))),a.nextPage=a.nextPage.bind(Object(v.a)(Object(v.a)(a))),a.handleContentSelect=a.handleContentSelect.bind(Object(v.a)(Object(v.a)(a))),a.resetContentSelect=a.resetContentSelect.bind(Object(v.a)(Object(v.a)(a))),a.submitCurrent=a.submitCurrent.bind(Object(v.a)(Object(v.a)(a))),a.handleMobileInput=a.handleMobileInput.bind(Object(v.a)(Object(v.a)(a))),a}return Object(b.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.id;console.log("User "+this.props.userId),"true"===this.props.newUser||void 0===this.props.newUser?this.setState({redirect:"/instructions/?redirect=".concat(e)}):(this.setState({gameId:e}),this.getGame(e))}},{key:"getGame",value:function(e){var t=this;m.a.get("/api/games/".concat(e)).then(function(e){e.data&&(t.setState({gameName:e.data[0].name,gameSnippets:e.data[0].snippets}),t.getSnippet(t.state.pageNum))}).catch(function(e){return console.log(e)})}},{key:"getSnippet",value:function(e){var t=this;m.a.get("/api/snippets/".concat(this.state.gameSnippets[e-1].id)).then(function(e){e.data&&t.setState({currSnippet:e.data[0],loadingNew:!1})}).catch(function(e){return console.log(e)})}},{key:"nextPage",value:function(){this.state.pageNum+1>this.state.gameSnippets.length?this.setState({redirect:"/game-results/".concat(this.state.gameId,"/?next=true")}):(this.setState({pageNum:this.state.pageNum+1,submittedCurrent:!1}),this.getSnippet(this.state.pageNum+1),this.resetContentSelect())}},{key:"handleContentSelect",value:function(e){var t={text:e.selection,start:e.selectionStart,end:e.selectionEnd};this.setState({highlightedRange:[t]})}},{key:"resetContentSelect",value:function(){var e=this;this.setState({loadingNew:!0,highlightedRange:[]},function(){window.setTimeout(function(){e.setState({loadingNew:!1})},100)})}},{key:"handleMobileInput",value:function(e){var t=e.target.value,a=this.state.currSnippet.text.indexOf(t),n=this.state.currSnippet.text.indexOf(t)+t.length-1;if(a>=0&&a<this.state.currSnippet.text.length&&n>=0&&n<this.state.currSnippet.text.length&&n>a){var i={text:t,start:a,end:n};this.setState({highlightedRange:[i]})}this.setState({mobileInput:t})}},{key:"submitCurrent",value:function(){var e=this,t=Array.apply(null,Array(this.state.currSnippet.text.length)).map(function(e){return!1}),a=function(a){var n=e.state.highlightedRange[a],i=n.start,s=n.end;t=t.map(function(e,t){return t>=i&&t<=s||e})};for(var n in this.state.highlightedRange)a(n);this.setState({submittedCurrent:!0,fullSnippets:this.state.fullSnippets.concat(this.state.currSnippet),selections:this.state.selections.concat([t]),mobileInput:""},function(){if(e.state.pageNum===e.state.gameSnippets.length&&e.state.fullSnippets.length===e.state.selections.length)for(var t in e.state.fullSnippets){var a={user:e.props.userId,selection:e.state.selections[t]},n={text:e.state.fullSnippets[t].text,id:e.state.fullSnippets[t].id,interps:e.state.fullSnippets[t].interps.length>0?e.state.fullSnippets[t].interps.concat([a]):[a]};m.a.patch("/api/snippets/".concat(e.state.fullSnippets[t].id),n).then(function(e){e.data}).catch(function(e){return console.log(e)})}})}},{key:"render",value:function(){var e=this;if(this.state.redirect)return i.a.createElement(p.a,{to:this.state.redirect});var t=i.a.createElement("div",null),a=i.a.createElement("div",null),n=i.a.createElement("div",null);if(this.state.currSnippet&&!this.state.loadingNew&&(a=i.a.createElement(C.a,{text:this.state.currSnippet.text,selectionHandler:this.handleContentSelect,customClass:"highlighted"})),this.props.isTouch&&!this.state.submittedCurrent&&(t=i.a.createElement("div",null,i.a.createElement("p",{style:{float:"left",paddingLeft:20}},"Paste your selection"),i.a.createElement("input",{type:"text",onChange:this.handleMobileInput,name:"mobileInput",value:this.state.mobileInput}))),this.state.submittedCurrent){var s=this.state.fullSnippets[this.state.pageNum-1].interps.concat({selection:this.state.selections[this.state.pageNum-1]});n=i.a.createElement(k,{snippetData:this.state.currSnippet,interpsData:s,method:"highlight"})}var r=this.state.highlightedRange.length>0,l=i.a.createElement("div",null,i.a.createElement("button",{onClick:this.resetContentSelect,className:"light"},"Reset Selection"),i.a.createElement("button",{onClick:r?this.submitCurrent:function(){},className:r?"":"disabled","data-tip":!0,"data-for":"helpMakingSelection"},"Compare Selection \u2192"),i.a.createElement(O.a,{id:"helpMakingSelection",place:"top",type:"dark",effect:"solid",clickable:!0,className:"helpTooltip",getContent:function(){return r?null:"Highlight the meaningful portion of the text to continue"}}));return this.state.submittedCurrent&&(l=i.a.createElement("button",{onClick:this.nextPage},this.state.pageNum===this.state.gameSnippets.length?"Summary \u2192":"Next Page \u2192")),i.a.createElement("div",{className:"playWrapper"},i.a.createElement("div",{className:"playHeader"},i.a.createElement("span",{style:{float:"left"}},this.state.gameName),i.a.createElement("span",{style:{float:"right"}},this.state.pageNum,"/",this.state.gameSnippets.length)),i.a.createElement("div",{className:"snipArea"},i.a.createElement("div",{className:"padder","data-tip":!0,"data-for":"yourSelection"},a),i.a.createElement(O.a,{id:"yourSelection",place:"left",type:"dark",effect:"solid",className:"helpTooltip",getContent:function(){return e.state.submittedCurrent?"Your interpretation":null}}),i.a.createElement("div",{className:"padder","data-tip":!0,"data-for":"allSelection"},n),i.a.createElement(O.a,{id:"allSelection",place:"left",type:"dark",effect:"solid",className:"helpTooltip",getContent:function(){return e.state.submittedCurrent?"Everyone's interpretation":null}})),t,l)}}]),t}(i.a.Component),w=a(38),I=a(18),D=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(f.a)(t).call(this,e))).state={games:[],snippets:[],gameName:"",gameSnippets:"",snippetText:""},a.getData=a.getData.bind(Object(v.a)(Object(v.a)(a))),a.handleChange=a.handleChange.bind(Object(v.a)(Object(v.a)(a))),a.addGame=a.addGame.bind(Object(v.a)(Object(v.a)(a))),a.addSnippet=a.addSnippet.bind(Object(v.a)(Object(v.a)(a))),a.deleteItem=a.deleteItem.bind(Object(v.a)(Object(v.a)(a))),a}return Object(b.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getData()}},{key:"getData",value:function(){var e=this;m.a.get("/api/games").then(function(t){t.data&&e.setState({games:t.data})}).catch(function(e){return console.log(e)}),m.a.get("/api/snippets").then(function(t){t.data&&e.setState({snippets:t.data})}).catch(function(e){return console.log(e)})}},{key:"handleChange",value:function(e){var t=e.target,a=t.value,n=t.name;this.setState(Object(w.a)({},n,a))}},{key:"addGame",value:function(){var e=this;if(this.state.gameName.length>0&&this.state.gameSnippets.length>0){var t=this.state.gameSnippets.split(", ").map(function(e){return{id:e}});console.log(t);var a={name:this.state.gameName,id:I(),snippets:t};m.a.post("/api/games",a).then(function(t){t.data&&(e.setState({gameName:"",gameSnippets:""}),e.getData())}).catch(function(e){return console.log(e)})}else console.log("input field required")}},{key:"addSnippet",value:function(){var e=this;if(this.state.snippetText.length>0){var t={text:this.state.snippetText,id:I(),interps:[]};m.a.post("/api/snippets",t).then(function(t){t.data&&(e.setState({snippetText:""}),e.getData())}).catch(function(e){return console.log(e)})}else console.log("input field required")}},{key:"deleteItem",value:function(e,t){var a=this;m.a.delete("/api/".concat(t,"/").concat(e)).then(function(e){e.data&&a.getData()}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){var e=this,t=this.state,a=t.games,n=t.snippets,s=a.map(function(t){return i.a.createElement("div",{className:"item",key:I()},i.a.createElement("h4",null,"Name"),i.a.createElement("p",null,t.name),i.a.createElement("h4",null,"ID"),i.a.createElement("p",null,t.id),i.a.createElement("button",{onClick:function(){return e.deleteItem(t.id,"games")}},"Delete"))}),r=n.map(function(t){return i.a.createElement("div",{className:"item",key:I()},i.a.createElement("h4",null,"Text"),i.a.createElement("p",null,t.text),i.a.createElement("h4",null,"ID"),i.a.createElement("p",null,t.id),i.a.createElement("button",{onClick:function(){return e.deleteItem(t.id,"snippets")}},"Delete"))});return i.a.createElement("div",{className:"wrapper"},i.a.createElement("h1",null,"Games"),i.a.createElement("div",{className:"wrapperFlex"},s,i.a.createElement("div",{className:"item"},i.a.createElement("h2",null,"Add Game"),i.a.createElement("h4",null,"Name"),i.a.createElement("input",{type:"text",onChange:this.handleChange,name:"gameName",value:this.state.gameName}),i.a.createElement("h4",null,"Snippets"),i.a.createElement("input",{type:"text",onChange:this.handleChange,name:"gameSnippets",value:this.state.gameSnippets}),i.a.createElement("button",{onClick:this.addGame},"Add Game"))),i.a.createElement("h1",null,"Snippets"),i.a.createElement("div",{className:"wrapperFlex"},r,i.a.createElement("div",{className:"item"},i.a.createElement("h2",null,"Add Snippet"),i.a.createElement("h4",null,"Text"),i.a.createElement("input",{type:"text",onChange:this.handleChange,name:"snippetText",value:this.state.snippetText}),i.a.createElement("button",{onClick:this.addSnippet},"Add Snippet"))))}}]),t}(i.a.Component),G=a(35),T=function(e){var t=Object(n.useState)(void 0),a=Object(c.a)(t,2),s=a[0],r=a[1],o=Object(l.b)(["newUser"]),u=Object(c.a)(o,2),m=u[0];(0,u[1])("newUser",!1,{path:"/"});var h=G.parse(e.location.search),d=h.redirect?"/play/".concat(h.redirect):"/";if(console.log(m),s)return i.a.createElement(p.a,{to:s});var g=i.a.createElement("span",null);return e.isTouch&&(g=i.a.createElement("p",null,"Since you are on mobile, please copy your selection and paste it in the input box below the text.")),i.a.createElement("div",{className:"playWrapper padded"},i.a.createElement("h2",null,"Instructions"),i.a.createElement("div",{className:"padder"},i.a.createElement("p",null,"This survey aims to examine how people interpret meaning in text. You will be presented with a group of snippets of text from a common source."),i.a.createElement("p",null,i.a.createElement("b",null,"For each snippet of text, determine which part you find"," ",i.a.createElement("em",null,"meaningful")," and highlight it.")),g,i.a.createElement("p",null,"After submitting, you'll see how others interpreted the same passage of text."),i.a.createElement("p",null,"Thanks for your contribution!")),i.a.createElement("button",{onClick:function(){return r(d)}},"Get Started \u2192"))},M=a(18),A=a(35),P=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(f.a)(t).call(this,e))).state={gameName:""},a}return Object(b.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=A.parse(this.props.location.search),a=this.props.match.params.id;t.next&&m.a.get("/api/games/").then(function(t){if(t.data){var n=0;for(var i in t.data)t.data[i].id===a&&(n=i);(n=parseInt(n))+1>t.data.length-1?n=0:n+=1,e.setState({nextPage:"/play/".concat(t.data[n].id)})}}).catch(function(e){return console.log(e)}),m.a.get("/api/games/".concat(a)).then(function(t){t.data&&(e.setState({gameName:t.data[0].name,gameSnippets:t.data[0].snippets}),m.a.get("/api/snippets/".concat(t.data[0].snippets[0].id)).then(function(t){t.data&&e.setState({gamePlays:t.data[0].interps.length})}).catch(function(e){return console.log(e)}))}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){var e=this;if(this.state.redirect)return i.a.createElement(p.a,{to:this.state.redirect});var t=i.a.createElement("div",null),a=i.a.createElement("div",null);return this.state.gameSnippets&&(t=this.state.gameSnippets.map(function(e){return i.a.createElement("div",{className:"padder",key:M()},i.a.createElement(k,{snippetId:e.id,method:"opacity"}))})),this.state.nextPage&&(a=i.a.createElement("div",null,i.a.createElement("button",{onClick:function(){return e.setState({redirect:"/"})},className:"light"},"All Groups"),i.a.createElement("button",{onClick:function(){return e.setState({redirect:e.state.nextPage})}},"Interpret Another Group \u2192"))),i.a.createElement("div",{className:"playWrapper"},i.a.createElement("div",{className:"playHeader"},i.a.createElement("span",{style:{float:"left"}},this.state.gameName)),i.a.createElement("div",{className:"snipArea"},t),a)}}]),t}(i.a.Component),R=(a(98),a(18)),U=function(e){var t=Object(n.useState)(""),a=Object(c.a)(t,2),s=a[0],r=a[1];m.a.get("/api/games").then(function(e){if(e.data){var t=Math.floor(Math.random()*e.data.length);r(e.data[t].id)}}).catch(function(e){return console.log(e)});var l=i.a.createElement("div",null);return""!==s&&(l=i.a.createElement(p.a,{to:"/play/".concat(s,"/")})),l},W=function(){var e=Object(l.b)(["userId"]),t=Object(c.a)(e,2),a=t[0],s=t[1],r=Object(l.b)(["newUser"]),u=Object(c.a)(r,2),m=u[0],h=u[1];Object(n.useEffect)(function(){void 0===a.userId&&(s("userId",R(),{path:"/"}),h("newUser",!0,{path:"/"}))});var d=!matchMedia("(pointer:fine)").matches;return i.a.createElement(o.a,null,i.a.createElement("div",null,i.a.createElement(p.b,{exact:!0,path:"/",render:function(e){return i.a.createElement(S,Object.assign({},e,{userId:a.userId}))}}),i.a.createElement(p.b,{path:"/random",render:function(e){return i.a.createElement(U,e)}}),i.a.createElement(p.b,{path:"/instructions",render:function(e){return i.a.createElement(T,Object.assign({},e,{isTouch:d}))}}),i.a.createElement(p.b,{path:"/admin",component:D}),i.a.createElement(p.b,{path:"/play/:id",render:function(e){return i.a.createElement(x,Object.assign({},e,{userId:a.userId,newUser:m.newUser,isTouch:d}))}}),i.a.createElement(p.b,{path:"/results/game/:id",render:function(e){return i.a.createElement(x,Object.assign({},e,{userId:a.userId}))}}),i.a.createElement(p.b,{path:"/snip-results/:id",component:k}),i.a.createElement(p.b,{path:"/game-results/:id",component:P})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(l.a,null,i.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[40,1,2]]]);
//# sourceMappingURL=main.a0a0fa93.chunk.js.map